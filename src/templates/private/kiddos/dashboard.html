{% extends "bases/private.html" %}

{% block title %}{{ kid.name }}'s Dashboard - Stewardwell{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/kid.css') }}">
{% endblock %}

{% block nav %}
<a href="{{ url_for('kid.logout') }}">Logout</a>
{% endblock %}

{% block content %}
<div class="kid-dashboard">
        <div class="kid-header">
            <div class="kid-welcome">
                <h1>ğŸ‘‹ Hi {{ kid.name }}!</h1>
                <p>Let's get some chores done!</p>
            </div>
            <div class="kid-coins">
                <div class="coin-display">ğŸª™ {{ kid.coin_balance }}</div>
                <div class="coin-label">Coins</div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="kid-nav">
            <a href="{{ url_for('kid.dashboard') }}" class="nav-btn active">
                ğŸ“‹ Chores
            </a>
            <a href="{{ url_for('kid.store') }}" class="nav-btn">
                ğŸ›’ Store
            </a>
        </div>
        
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="flash {{ category }}">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        
        <!-- Available Chores -->
        <div class="chore-section">
            <h2>ğŸ“‹ Available Chores</h2>
            {% if available_chores %}
                <div class="chore-grid">
                    {% for chore in available_chores %}
                    <div class="chore-card">
                        <div class="chore-info">
                            <h3>{{ chore.name }}</h3>
                            <div class="chore-rewards">
                                <span>ğŸª™ {{ chore.coin_value }} coins</span>
                                <span>â­ {{ chore.point_value }} points</span>
                                {% if chore.frequency != 'unlimited' %}
                                    <span class="frequency-tag">
                                        {% if chore.frequency == 'daily' %}ğŸ“… Daily
                                        {% elif chore.frequency == 'weekly' %}ğŸ“† Weekly
                                        {% elif chore.frequency == 'monthly' %}ğŸ—“ï¸ Monthly
                                        {% elif chore.frequency == 'one_time' %}ğŸ”’ One Time
                                        {% endif %}
                                    </span>
                                {% endif %}
                            </div>
                        </div>
                        <form method="POST" action="{{ url_for('kid.pick_chore', chore_id=chore.id) }}">
                            <button type="submit" class="btn-chore btn-pick">Pick This!</button>
                        </form>
                    </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="empty-state">No chores available right now. Check back later! ğŸŒŸ</div>
            {% endif %}
        </div>
        
        <!-- Active Chores -->
        <div class="chore-section">
            <h2>ğŸ”„ Your Active Chores</h2>
            {% if active_assignments %}
                <div class="chore-grid">
                    {% for assignment in active_assignments %}
                    <div class="chore-card">
                        <div class="chore-info">
                            <h3>{{ assignment.chore.name }}</h3>
                            <div class="chore-rewards">
                                <span>ğŸª™ {{ assignment.chore.coin_value }} coins</span>
                                <span>â­ {{ assignment.chore.point_value }} points</span>
                            </div>
                        </div>
                        <form method="POST" action="{{ url_for('kid.complete_chore', assignment_id=assignment.id) }}">
                            <button type="submit" class="btn-chore btn-complete">Mark Complete!</button>
                        </form>
                    </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="empty-state">No active chores. Pick one above! ğŸ’ª</div>
            {% endif %}
        </div>
        
        <!-- Pending Approval -->
        <div class="chore-section">
            <h2>â³ Waiting for Parent Approval</h2>
            {% if pending_assignments %}
                <div class="chore-grid">
                    {% for assignment in pending_assignments %}
                    <div class="chore-card">
                        <div class="chore-info">
                            <h3>{{ assignment.chore.name }}</h3>
                            <div class="chore-rewards">
                                <span>ğŸª™ {{ assignment.chore.coin_value }} coins</span>
                                <span>â­ {{ assignment.chore.point_value }} points</span>
                            </div>
                        </div>
                        <span class="pending-badge">Pending â³</span>
                    </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="empty-state">No chores waiting for approval. ğŸ‘</div>
            {% endif %}
        </div>
        
</div>
{% endblock %}